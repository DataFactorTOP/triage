<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Documentation for Triage.">
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Feature Generation Recipe Book - Triage Documentation</title>
        <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.3/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.3.7.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
         
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Triage Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Experiment Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../defining/">Defining an Experiment</a>
                        </li>
                    
                        <li >
                            <a href="../feature-testing/">Testing Feature Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../running/">Running an Experiment</a>
                        </li>
                    
                        <li >
                            <a href="../temporal-validation/">Temporal Validation Deep Dive</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Feature Generation Recipe Book</a>
                        </li>
                    
                        <li >
                            <a href="../algorithm/">Experiment Algorithm</a>
                        </li>
                    
                        <li >
                            <a href="../architecture/">Experiment Architecture</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                    <li >
                        <a rel="next" href="../temporal-validation/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../algorithm/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                <li>
                    <a href="http://github.com/dssg/triage/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="row">
                    <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
      
    
        <li class="main active"><a href="#feature-generation-recipe-book">Feature Generation Recipe Book</a></li>
        
            <li><a href="#age">Age</a></li>
        
    
    
    </ul>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="feature-generation-recipe-book">Feature Generation Recipe Book<a class="headerlink" href="#feature-generation-recipe-book" title="Permanent link">&para;</a></h2>
<p>This document is a collection of 'collate' aggregate features that we have found useful to create in Triage that may not be apparent at first.</p>
<p>For an introduction to feature generation in Triage, refer to <a href="https://dssg.github.io/dirtyduck/#orgaae2e66">Dirty Duck Feature Generation</a></p>
<h3 id="age">Age<a class="headerlink" href="#age" title="Permanent link">&para;</a></h3>
<p>You can calculate age from a date of birth column using the <code>collate_date</code> special variable. This variable is marked as a placeholder in the feature quantity input, but is replaced with each as-of-date when features are being calculated. Combined with the Postgres <code>age</code> function, this calculates a person's age at each as-of-date as a feature.</p>
<p>For this example, let's assume you have a column called 'dob' that is a timestamp (or anything that can be cast to a date) in your source table. The <code>feature_aggregation</code>'s quantity would be: </p>
<p><code>EXTRACT(YEAR FROM AGE('{collate_date}'::DATE, dob::DATE))</code></p>
<p>If Triage is calculating this for the as-of-date '2016-01-01', it will internally expand the <code>collate_date</code> out to:
<code>EXTRACT(YEAR FROM AGE('2016-01-01'::DATE, dob::DATE))</code></p>
<p>In context, a feature aggregate that uses age may look more like:</p>
<pre><code>    aggregates:
      - # age in years 
        quantity:
          age: &quot;EXTRACT(YEAR FROM AGE('{collate_date}'::DATE, dob::DATE))&quot;
        metrics: ['max']
</code></pre>

<p>Here, we call the feature 'age' and since everything in collate is defined as an aggregate, we pick 'max'; Any records for the same person and as-of-date should have the same 'dob', so there are many aggregates you can use that will arrive at the same answer (e.g. 'min', 'avg'). In these cases 'max' is the standard aggregate metric of choice in Triage.</p></div>
                </div>
        </div>

    <hr>
    <footer class="container">
        
        <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
    </footer>
        <script src="../../js/base.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>
    </body>
</html>