



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for Triage.">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Model governance - Triage Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.750b69bd.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#546e7a">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#machine-learning-governance" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../postmodeling/" title="Triage Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon">book</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Triage Documentation
            </span>
            <span class="md-header-nav__topic">
              Model governance
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="http://github.com/dssg/triage/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    dssg/triage
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../postmodeling/" title="Triage Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">book</i>
      
    </a>
    Triage Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="http://github.com/dssg/triage/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    dssg/triage
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../index.md" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Dirty Duck Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Dirty Duck Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Welcome!" class="md-nav__link">
      Welcome!
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../who_is_this_tutorial_for/" title="Who is this tutorial for?" class="md-nav__link">
      Who is this tutorial for?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../choose_your_own_adventure/" title="Choose your own adventure" class="md-nav__link">
      Choose your own adventure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Setup
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Setup
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../for_the_impatient/" title="Quick setup" class="md-nav__link">
      Quick setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../infrastructure/" title="Infrastructure" class="md-nav__link">
      Infrastructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data_preparation/" title="Data preparation" class="md-nav__link">
      Data preparation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Case studies
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        Case studies
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../problem_description/" title="Problem description" class="md-nav__link">
      Problem description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eis/" title="Early Warning System" class="md-nav__link">
      Early Warning System
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../inspections/" title="Resource prioritization" class="md-nav__link">
      Resource prioritization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Triage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        Triage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../triage_intro/" title="A deeper look into triage" class="md-nav__link">
      A deeper look into triage
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Experiment
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Experiment
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/defining/" title="Defining an Experiment" class="md-nav__link">
      Defining an Experiment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/feature-testing/" title="Testing Feature Configuration" class="md-nav__link">
      Testing Feature Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/dssg/triage/blob/master/example/config/README.md" title="Experiment Configuration" class="md-nav__link">
      Experiment Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/running/" title="Running an Experiment" class="md-nav__link">
      Running an Experiment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Upgrading an Experiment
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        Upgrading an Experiment
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/upgrade-to-v7/" title="v6 -> v7" class="md-nav__link">
      v6 -> v7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/upgrade-to-v6/" title="v5 -> v6" class="md-nav__link">
      v5 -> v6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/upgrade-to-v5/" title="v3/v4 -> v5" class="md-nav__link">
      v3/v4 -> v5
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/temporal-validation/" title="Temporal Validation Deep Dive" class="md-nav__link">
      Temporal Validation Deep Dive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/cohort-labels/" title="Cohort and Label Deep Dive" class="md-nav__link">
      Cohort and Label Deep Dive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/prediction-ranking/" title="Prediction Ranking" class="md-nav__link">
      Prediction Ranking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/features/" title="Feature Generation Recipe Book" class="md-nav__link">
      Feature Generation Recipe Book
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/algorithm/" title="Experiment Algorithm" class="md-nav__link">
      Experiment Algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../experiments/architecture/" title="Experiment Architecture" class="md-nav__link">
      Experiment Architecture
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../audition/" title="Model selection" class="md-nav__link">
      Model selection
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../postmodeling/" title="Postmodeling" class="md-nav__link">
      Postmodeling
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Model governance
      </label>
    
    <a href="./" title="Model governance" class="md-nav__link md-nav__link--active">
      Model governance
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-all-the-results-tables-about" title="What are all the results tables about?" class="md-nav__link">
    What are all the results tables about?
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model_metadataexperiments" title="model_metadata.experiments" class="md-nav__link">
    model_metadata.experiments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadata_modelmodel_groups" title="metadata_model.model_groups" class="md-nav__link">
    metadata_model.model_groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model_metadatamodels" title="model_metadata.models" class="md-nav__link">
    model_metadata.models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model_metadatamatrices" title="model_metadata.matrices" class="md-nav__link">
    model_metadata.matrices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-train_resultsevaluations" title="{test, train}_results.evaluations" class="md-nav__link">
    {test, train}_results.evaluations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test_train_resultsaequitas" title="{test_train}_results.aequitas" class="md-nav__link">
    {test_train}_results.aequitas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-train_resultspredictions" title="{test, train}_results.predictions" class="md-nav__link">
    {test, train}_results.predictions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-train_resultsfeature_importances" title="{test, train}_results.feature_importances" class="md-nav__link">
    {test, train}_results.feature_importances
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#footnotes" title="Footnotes" class="md-nav__link">
    Footnotes
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aws_batch/" title="Scaling up" class="md-nav__link">
      Scaling up
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-all-the-results-tables-about" title="What are all the results tables about?" class="md-nav__link">
    What are all the results tables about?
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model_metadataexperiments" title="model_metadata.experiments" class="md-nav__link">
    model_metadata.experiments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadata_modelmodel_groups" title="metadata_model.model_groups" class="md-nav__link">
    metadata_model.model_groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model_metadatamodels" title="model_metadata.models" class="md-nav__link">
    model_metadata.models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model_metadatamatrices" title="model_metadata.matrices" class="md-nav__link">
    model_metadata.matrices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-train_resultsevaluations" title="{test, train}_results.evaluations" class="md-nav__link">
    {test, train}_results.evaluations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test_train_resultsaequitas" title="{test_train}_results.aequitas" class="md-nav__link">
    {test_train}_results.aequitas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-train_resultspredictions" title="{test, train}_results.predictions" class="md-nav__link">
    {test, train}_results.predictions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-train_resultsfeature_importances" title="{test, train}_results.feature_importances" class="md-nav__link">
    {test, train}_results.feature_importances
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#footnotes" title="Footnotes" class="md-nav__link">
    Footnotes
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="http://github.com/dssg/triage/edit/master/docs/sources/dirtyduck/ml_governance.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="machine-learning-governance">Machine learning governance<a class="headerlink" href="#machine-learning-governance" title="Permanent link">#</a></h1>
<p>When <code>triage</code> executes the experiment, it creates a series of new schemas for storing the copious output of the experiment. The schemas are <code>test_results, train_results</code>, and <code>model_metadata</code>. These schemas store the metadata of the trained models, features, parameters, and hyperparameters used in their training. It also stores the predictions and evaluations of the models on the test sets.</p>
<p>The schema <code>model_metadata</code> is composed by the tables:</p>
<div class="highlight"><pre><span></span><span class="err">\</span><span class="n">dt</span> <span class="n">model_metadata</span><span class="p">.</span><span class="o">*</span>
</pre></div>

<table>
<thead>
<tr>
<th>List of relations</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Schema</td>
<td>Name</td>
<td>Type</td>
<td>Owner</td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>experiment<sub>matrices</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>experiment<sub>models</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>experiments</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>list<sub>predictions</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>matrices</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>model<sub>groups</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>model<sub>metadata</sub></td>
<td>models</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
</tbody>
</table>
<p>The tables contained in <code>test_results</code> are:</p>
<div class="highlight"><pre><span></span><span class="err">\</span><span class="n">dt</span> <span class="n">test_results</span><span class="p">.</span><span class="o">*</span>
</pre></div>

<table>
<thead>
<tr>
<th>List of relations</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Schema</td>
<td>Name</td>
<td>Type</td>
<td>Owner</td>
</tr>
<tr>
<td>test<sub>results</sub></td>
<td>aequitas</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>test<sub>results</sub></td>
<td>evaluations</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>test<sub>results</sub></td>
<td>individual<sub>importances</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>test<sub>results</sub></td>
<td>predictions</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
</tbody>
</table>
<p>Lastly, if you have interest in how the model performed in the <em>training</em> data sets you could consult <code>train_results</code></p>
<div class="highlight"><pre><span></span><span class="err">\</span><span class="n">dt</span> <span class="n">train_results</span><span class="p">.</span><span class="o">*</span>
</pre></div>

<table>
<thead>
<tr>
<th>List of relations</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Schema</td>
<td>Name</td>
<td>Type</td>
<td>Owner</td>
</tr>
<tr>
<td>train<sub>results</sub></td>
<td>aequitas</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>train<sub>results</sub></td>
<td>evaluations</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>train<sub>results</sub></td>
<td>feature<sub>importances</sub></td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
<tr>
<td>train<sub>results</sub></td>
<td>predictions</td>
<td>table</td>
<td>food<sub>user</sub></td>
</tr>
</tbody>
</table>
<h2 id="what-are-all-the-results-tables-about">What are all the results tables about?<a class="headerlink" href="#what-are-all-the-results-tables-about" title="Permanent link">#</a></h2>
<p><code>model_groups</code> stores the algorithm (<code>model_type</code>), the hyperparameters (<code>hyperparameters</code>), and the features shared by a particular set of models. <code>models</code> contains data specific to a model: the <code>model_group</code> (you can use <code>model_group_id</code> for linking the model to a model group), temporal information (like <code>train_end_time</code>), and the train matrix UUID (<code>train_matrix_uuid</code>). This <strong>UUID</strong> is important because it's the name of the file in which the matrix is stored.</p>
<p>Lastly, <code>{train, test}_results.predictions</code> contains all the <em>scores</em> generated by every model for every entity. <code>{train_test}_results.evaluation</code> stores the value of all the <strong>metrics</strong> for every model, which were specified in the <code>scoring</code> section in the config file.</p>
<h3 id="model_metadataexperiments"><code>model_metadata.experiments</code><a class="headerlink" href="#model_metadataexperiments" title="Permanent link">#</a></h3>
<p>This table has the two columns: <code>experiment_hash</code> and <code>config</code></p>
<div class="highlight"><pre><span></span><span class="err">\</span><span class="n">d</span> <span class="n">model_metadata</span><span class="p">.</span><span class="n">experiments</span>
</pre></div>

<table>
<thead>
<tr>
<th>Table "model<sub>metadata.experiments</sub>"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>experiment<sub>hash</sub></td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>config</td>
<td>jsonb</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Indexes:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"experiments<sub>pkey</sub>" PRIMARY KEY, btree (experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Referenced by:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.experiment</sub><sub>matrices</sub>" CONSTRAINT "experiment<sub>matrices</sub><sub>experiment</sub><sub>hash</sub><sub>fkey</sub>" FOREIGN KEY (experiment<sub>hash</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.experiment</sub><sub>models</sub>" CONSTRAINT "experiment<sub>models</sub><sub>experiment</sub><sub>hash</sub><sub>fkey</sub>" FOREIGN KEY (experiment<sub>hash</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.matrices</sub>" CONSTRAINT "matrices<sub>built</sub><sub>by</sub><sub>experiment</sub><sub>fkey</sub>" FOREIGN KEY (built<sub>by</sub><sub>experiment</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.models</sub>" CONSTRAINT "models<sub>experiment</sub><sub>hash</sub><sub>fkey</sub>" FOREIGN KEY (built<sub>by</sub><sub>experiment</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><code>experiment_hash</code> contains the hash of the configuration file that we used for our <code>triage</code> run.<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup> <code>config</code> that contains the configuration experiment file that we used for our <code>triage</code> run, stored as <code>jsonb</code>.</p>
<div class="highlight"><pre><span></span><span class="k">select</span> <span class="n">experiment_hash</span><span class="p">,</span>
<span class="n">config</span> <span class="o">-&gt;</span>  <span class="s1">&#39;user_metadata&#39;</span> <span class="k">as</span> <span class="n">user_metadata</span>
<span class="k">from</span> <span class="n">model_metadata</span><span class="p">.</span><span class="n">experiments</span><span class="p">;</span>
</pre></div>

<table>
<thead>
<tr>
<th>experiment<sub>hash</sub></th>
<th>user<sub>metadata</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td>67a1d564d31811b9c20ca63672c25abd</td>
<td>{"org": "DSaPP", "team": "Tutorial", "author": "Adolfo De Unanue", "etl<sub>date</sub>": "2019-02-21", "experiment<sub>type</sub>": "test", "label<sub>definition</sub>": "failed<sub>inspection</sub>"}</td>
</tr>
</tbody>
</table>
<p>We could use the following advice: If we are interested in all models that resulted from a certain config, we could lookup that config in <code>model_metadata.experiments</code> and then use its <code>experiment_hash</code> on other tables to find all the models that resulted from that configuration.</p>
<h3 id="metadata_modelmodel_groups"><code>metadata_model.model_groups</code><a class="headerlink" href="#metadata_modelmodel_groups" title="Permanent link">#</a></h3>
<p>Do you remember how we defined in <code>grid_config</code> the different classifiers that we want <code>triage</code> to train? For example, we could use in a configuration file the following:</p>
<div class="highlight"><pre><span></span>    <span class="s">&#39;sklearn.tree.DecisionTreeClassifier&#39;</span><span class="p p-Indicator">:</span>
        <span class="nt">criterion</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;entropy&#39;</span><span class="p p-Indicator">]</span>
        <span class="nt">max_depth</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">2</span><span class="p p-Indicator">,</span> <span class="nv">5</span><span class="p p-Indicator">,</span> <span class="nv">10</span><span class="p p-Indicator">]</span>
        <span class="nt">random_state</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">2193</span><span class="p p-Indicator">]</span>
</pre></div>

<p>By doing so, we are saying that we want to train 4 decision trees (<code>max_depth</code> is one of <code>1, 2, 5, 10</code>). However, remember that we are using temporal crossvalidation to build our models, so we are going to have different temporal slices that we are training models on, e.g., 2010-2011, 2011-2012, etc.</p>
<p>Therefore, we are going to train our four decision trees on each temporal slice. Therefore, the trained model (or the instance of that model) will change across temporal splits, but the configuration will remain the same. This table lets us keep track of the different configurations (<code>model_groups</code>) and gives us an <code>id</code> for each configuration (<code>model_group_id</code>). We can leverage the <code>model_group_id</code> to find all the models that were trained using the same config but on different slices of time.</p>
<p>In our simple test configuration file we have:</p>
<div class="highlight"><pre><span></span>    <span class="s">&#39;sklearn.dummy.DummyClassifier&#39;</span><span class="p p-Indicator">:</span>
        <span class="nt">strategy</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">most_frequent</span><span class="p p-Indicator">]</span>
</pre></div>

<p>Therefore, if we run the following</p>
<div class="highlight"><pre><span></span><span class="k">select</span>
    <span class="n">model_group_id</span><span class="p">,</span>
    <span class="n">model_type</span><span class="p">,</span>
    <span class="n">hyperparameters</span><span class="p">,</span>
    <span class="n">model_config</span> <span class="o">-&gt;</span> <span class="s1">&#39;feature_groups&#39;</span> <span class="k">as</span> <span class="n">feature_groups</span><span class="p">,</span>
    <span class="n">model_config</span> <span class="o">-&gt;</span> <span class="s1">&#39;cohort_name&#39;</span> <span class="k">as</span> <span class="n">cohort</span><span class="p">,</span>
    <span class="n">model_config</span> <span class="o">-&gt;</span> <span class="s1">&#39;label_name&#39;</span> <span class="k">as</span> <span class="n">label</span><span class="p">,</span>
    <span class="n">model_config</span> <span class="o">-&gt;</span> <span class="s1">&#39;label_definition&#39;</span> <span class="k">as</span> <span class="n">label_definition</span><span class="p">,</span>
    <span class="n">model_config</span> <span class="o">-&gt;</span> <span class="s1">&#39;experiment_type&#39;</span> <span class="k">as</span> <span class="n">experiment_type</span><span class="p">,</span>
    <span class="n">model_config</span> <span class="o">-&gt;</span> <span class="s1">&#39;etl_date&#39;</span> <span class="k">as</span> <span class="n">etl_date</span>
<span class="k">from</span>
    <span class="n">model_metadata</span><span class="p">.</span><span class="n">model_groups</span><span class="p">;</span>
</pre></div>

<table>
<thead>
<tr>
<th>model<sub>group</sub><sub>id</sub></th>
<th>model<sub>type</sub></th>
<th>hyperparameters</th>
<th>feature<sub>groups</sub></th>
<th>cohort</th>
<th>label</th>
<th>label<sub>definition</sub></th>
<th>experiment<sub>type</sub></th>
<th>etl<sub>date</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>sklearn.dummy.DummyClassifier</td>
<td>{"strategy": "most<sub>frequent</sub>"}</td>
<td>["prefix: results", "prefix: risks", "prefix: inspections"]</td>
<td>"test<sub>facilities</sub>"</td>
<td>"failed<sub>inspections</sub>"</td>
<td>"failed<sub>inspection</sub>"</td>
<td>"test"</td>
<td>"2019-02-21"</td>
</tr>
</tbody>
</table>
<p>You can see that a model group is defined by the classifier (<code>model_type</code>), its hyperparameters (<code>hyperparameters</code>), the features (<code>feature_list</code>) (not shown), and the <code>model_config</code>.</p>
<p>The field <code>model_config</code> is created using information from the block <code>model_group_keys</code>. In our test configuration file the block is:</p>
<div class="highlight"><pre><span></span><span class="nt">model_group_keys</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;class_path&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;parameters&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;feature_names&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;feature_groups&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;cohort_name&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;state&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;label_name&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;label_timespan&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;training_as_of_date_frequency&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;max_training_history&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;label_definition&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;experiment_type&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;org&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;team&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;author&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;etl_date&#39;</span>
</pre></div>

<p><em>What can we learn from that?</em> For example, if we add a new feature and rerun <code>triage</code>, <code>triage</code> will create a new <code>model_group</code> even if the classifier and the <code>hyperparameters</code> are the same as before.</p>
<h3 id="model_metadatamodels"><code>model_metadata.models</code><a class="headerlink" href="#model_metadatamodels" title="Permanent link">#</a></h3>
<p>This table stores the information about our actual <em>models</em>, i.e., instances of our classifiers trained on specific temporal slices.</p>
<div class="highlight"><pre><span></span><span class="err">\</span><span class="n">d</span> <span class="n">model_metadata</span><span class="p">.</span><span class="n">models</span>
</pre></div>

<table>
<thead>
<tr>
<th>Table "model<sub>metadata.models</sub>"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>model<sub>id</sub></td>
<td>integer</td>
<td></td>
<td>not null</td>
<td>nextval('model<sub>metadata.models</sub><sub>model</sub><sub>id</sub><sub>seq</sub>'::regclass)</td>
</tr>
<tr>
<td>model<sub>group</sub><sub>id</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>model<sub>hash</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>run<sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>batch<sub>run</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>model<sub>type</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>hyperparameters</td>
<td>jsonb</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>model<sub>comment</sub></td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>batch<sub>comment</sub></td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>config</td>
<td>json</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>built<sub>by</sub><sub>experiment</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>train<sub>end</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>test</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>train<sub>matrix</sub><sub>uuid</sub></td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>training<sub>label</sub><sub>timespan</sub></td>
<td>interval</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>model<sub>size</sub></td>
<td>real</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Indexes:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"models<sub>pkey</sub>" PRIMARY KEY, btree (model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"ix<sub>results</sub><sub>models</sub><sub>model</sub><sub>hash</sub>" UNIQUE, btree (model<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Foreign-key constraints:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"matrix<sub>uuid</sub><sub>for</sub><sub>models</sub>" FOREIGN KEY (train<sub>matrix</sub><sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"models<sub>experiment</sub><sub>hash</sub><sub>fkey</sub>" FOREIGN KEY (built<sub>by</sub><sub>experiment</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"models<sub>model</sub><sub>group</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>group</sub><sub>id</sub>) REFERENCES model<sub>metadata.model</sub><sub>groups</sub>(model<sub>group</sub><sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Referenced by:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.evaluations</sub>" CONSTRAINT "evaluations<sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.feature</sub><sub>importances</sub>" CONSTRAINT "feature<sub>importances</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.individual</sub><sub>importances</sub>" CONSTRAINT "individual<sub>importances</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.list</sub><sub>predictions</sub>" CONSTRAINT "list<sub>predictions</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.predictions</sub>" CONSTRAINT "predictions<sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.evaluations</sub>" CONSTRAINT "train<sub>evaluations</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.predictions</sub>" CONSTRAINT "train<sub>predictions</sub><sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Noteworthy columns are:</p>
<ul>
<li><strong><code>model_id</code>:</strong> The id of the model (i.e., instance&#x2026;). We will use this ID to trace a model evaluation to a <code>model_group</code> and vice versa.</li>
<li><strong><code>model_group_id</code>:</strong> The id of the models <em>model group</em> we encountered above.</li>
<li><strong><code>model_hash</code>:</strong> The <em>hash</em> of our model. We can use the hash to load the actual model. It gets stored under <code>TRIAGE_OUTPUT_PATH/trained_models/{model_hash}</code>. We are going to this later to look at a trained decision tree.</li>
<li><strong><code>run_time</code>:</strong> Time when the model was trained.</li>
<li><strong><code>model_type</code>:</strong> The algorithm used for training.</li>
<li><strong><code>model_comment</code>:</strong> Literally the text in the <code>model_comment</code> block in the configuration file</li>
<li><strong><code>hyperparameters</code>:</strong> Hyperparameters used for the model configuration.</li>
<li><strong><code>built_by_experiment</code>:</strong> The hash of our experiment. We encountered this value in the <code>results.experiments</code> table before.</li>
<li><strong><code>train_end_time</code>:</strong> When building the training matrix, we included training samples up to this date.</li>
<li><strong><code>train_matrix_uuid</code>:</strong> The <em>hash</em> of the matrix that we used to train this model. The matrix gets stored as <code>csv</code> under <code>TRIAGE_OUTPUT_PATH/matrices/{train_matrix_uuid}.csv</code>. This is helpful when trying to inspect the matrix and features that were used for training.</li>
<li><strong><code>train_label_timespan</code>:</strong> How big was our window to get the labels for our training matrix? For example, a <code>train_label_window</code> of 1 year would mean that we look one year from a given date in the training matrix into the future to find the label for that training sample.</li>
</ul>
<h3 id="model_metadatamatrices"><code>model_metadata.matrices</code><a class="headerlink" href="#model_metadatamatrices" title="Permanent link">#</a></h3>
<p>This schema contains information about the matrices used in the model's training. You could use this information to debug your models. Important columns are <code>matrix_uuid</code> (The matrix gets stored as <code>TRIAGE_OUTPUT_PATH/matrices/{train_matrix_uuid}.csv</code>), <code>matrix_type</code> (indicated if the matrix was used for <em>training</em> models or <em>testing</em> them), <code>lookback_duration</code> and <code>feature_starttime</code> (give information about the temporal setting of the features) and <code>num_observations</code> (size of the matrices).</p>
<div class="highlight"><pre><span></span><span class="err">\</span><span class="n">d</span> <span class="n">model_metadata</span><span class="p">.</span><span class="n">matrices</span>
</pre></div>

<table>
<thead>
<tr>
<th>Table "model<sub>metadata.matrices</sub>"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>matrix<sub>id</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>matrix<sub>uuid</sub></td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>matrix<sub>type</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>labeling<sub>window</sub></td>
<td>interval</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num<sub>observations</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>creation<sub>time</sub></td>
<td>timestamp with time zone</td>
<td></td>
<td></td>
<td>now()</td>
</tr>
<tr>
<td>lookback<sub>duration</sub></td>
<td>interval</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>feature<sub>start</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>matrix<sub>metadata</sub></td>
<td>jsonb</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>built<sub>by</sub><sub>experiment</sub></td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Indexes:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"matrices<sub>pkey</sub>" PRIMARY KEY, btree (matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"ix<sub>model</sub><sub>metadata</sub><sub>matrices</sub><sub>matrix</sub><sub>uuid</sub>" UNIQUE, btree (matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Foreign-key constraints:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"matrices<sub>built</sub><sub>by</sub><sub>experiment</sub><sub>fkey</sub>" FOREIGN KEY (built<sub>by</sub><sub>experiment</sub>) REFERENCES model<sub>metadata.experiments</sub>(experiment<sub>hash</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Referenced by:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.evaluations</sub>" CONSTRAINT "evaluations<sub>matrix</sub><sub>uuid</sub><sub>fkey</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.evaluations</sub>" CONSTRAINT "evaluations<sub>matrix</sub><sub>uuid</sub><sub>fkey</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "model<sub>metadata.models</sub>" CONSTRAINT "matrix<sub>uuid</sub><sub>for</sub><sub>models</sub>" FOREIGN KEY (train<sub>matrix</sub><sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "test<sub>results.predictions</sub>" CONSTRAINT "matrix<sub>uuid</sub><sub>for</sub><sub>testpred</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.predictions</sub>" CONSTRAINT "matrix<sub>uuid</sub><sub>for</sub><sub>trainpred</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TABLE "train<sub>results.predictions</sub>" CONSTRAINT "train<sub>predictions</sub><sub>matrix</sub><sub>uuid</sub><sub>fkey</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="test-train_resultsevaluations"><code>{test, train}_results.evaluations</code><a class="headerlink" href="#test-train_resultsevaluations" title="Permanent link">#</a></h3>
<p>These tables lets us analyze how well our models are doing. Based on the config that we used for our <code>triage</code> run, <code>triage</code> is calculating metrics and storing them in this table, e.g., our model's precision in top 10%.</p>
<div class="highlight"><pre><span></span><span class="err">\</span><span class="n">d</span> <span class="n">test_results</span><span class="p">.</span><span class="n">evaluations</span>
</pre></div>

<table>
<thead>
<tr>
<th>Table "test<sub>results.evaluations</sub>"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>model<sub>id</sub></td>
<td>integer</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>evaluation<sub>start</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>evaluation<sub>end</sub><sub>time</sub></td>
<td>timestamp without time zone</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>as<sub>of</sub><sub>date</sub><sub>frequency</sub></td>
<td>interval</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>metric</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>parameter</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>value</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num<sub>labeled</sub><sub>examples</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num<sub>labeled</sub><sub>above</sub><sub>threshold</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num<sub>positive</sub><sub>labels</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>sort<sub>seed</sub></td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>matrix<sub>uuid</sub></td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Indexes:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"evaluations<sub>pkey</sub>" PRIMARY KEY, btree (model<sub>id</sub>, evaluation<sub>start</sub><sub>time</sub>, evaluation<sub>end</sub><sub>time</sub>, as<sub>of</sub><sub>date</sub><sub>frequency</sub>, metric, parameter)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Foreign-key constraints:</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"evaluations<sub>matrix</sub><sub>uuid</sub><sub>fkey</sub>" FOREIGN KEY (matrix<sub>uuid</sub>) REFERENCES model<sub>metadata.matrices</sub>(matrix<sub>uuid</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>"evaluations<sub>model</sub><sub>id</sub><sub>fkey</sub>" FOREIGN KEY (model<sub>id</sub>) REFERENCES model<sub>metadata.models</sub>(model<sub>id</sub>)</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Its columns are:</p>
<ul>
<li><strong><code>model_id</code>:</strong> Our beloved <code>model_id</code> that we have encountered before.</li>
<li><strong><code>evaluation_start_time</code>:</strong> After training the model, we evaluate it on a test matrix. This column tells us the earliest time that an example in our test matrix could have.</li>
<li><strong><code>evaluation_end_time</code>:</strong> After training the model, we evaluate it on a test matrix. This column tells us the latest time that an example in our test matrix could have.</li>
<li><strong><code>metric</code>:</strong> Indicates which metric we are evaluating, e.g., <code>precision@</code>.</li>
<li><code>parameter</code> ::Indicates at which parameter we are evaluating our metric, e.g., a metric of precision@ and a parameter of <code>100.0_pct</code> shows us the <code>precision@100pct</code>.</li>
<li><strong><code>value</code>:</strong> The value observed for our metric@parameter.</li>
<li><strong><code>num_labeled_examples</code>:</strong> The number of labeled examples in our test matrix. Why does it matter? It could be the case that we have entities that have no label for the test timeframe (for example, not all facilities will have an inspection). We still want to make predictions for these entities but can't include them when calculating performance metrics.</li>
<li><strong><code>num_labeled_above_threshold</code>:</strong> How many examples above our threshold were labeled?</li>
<li><strong><code>num_positive_labels</code>:</strong> The number of rows that had true positive labels.</li>
</ul>
<p>A look at the table shows that we have multiple rows for each model, each showing a different performance metric.</p>
<div class="highlight"><pre><span></span><span class="k">select</span>
    <span class="n">evaluation_end_time</span><span class="p">,</span>
    <span class="n">model_id</span><span class="p">,</span>
    <span class="n">metric</span> <span class="o">||</span> <span class="k">parameter</span> <span class="k">as</span> <span class="n">metric</span><span class="p">,</span>
    <span class="n">value</span><span class="p">,</span>
    <span class="n">num_labeled_examples</span><span class="p">,</span>
    <span class="n">num_labeled_above_threshold</span><span class="p">,</span>
    <span class="n">num_positive_labels</span>
<span class="k">from</span>
    <span class="n">test_results</span><span class="p">.</span><span class="n">evaluations</span>
<span class="k">where</span>
    <span class="k">parameter</span> <span class="o">=</span> <span class="s1">&#39;100.0_pct&#39;</span><span class="p">;</span>
</pre></div>

<table>
<thead>
<tr>
<th>evaluation<sub>end</sub><sub>time</sub></th>
<th>model<sub>id</sub></th>
<th>metric</th>
<th>value</th>
<th>num<sub>labeled</sub><sub>examples</sub></th>
<th>num<sub>labeled</sub><sub>above</sub><sub>threshold</sub></th>
<th>num<sub>positive</sub><sub>labels</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td>2016-01-01 00:00:00</td>
<td>1</td>
<td>precision@100.0<sub>pct</sub></td>
<td>0.6666666666666666</td>
<td>3</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>2016-01-01 00:00:00</td>
<td>1</td>
<td>recall@100.0<sub>pct</sub></td>
<td>1.0</td>
<td>3</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>2017-01-01 00:00:00</td>
<td>2</td>
<td>precision@100.0<sub>pct</sub></td>
<td>0.3333333333333333</td>
<td>3</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>2017-01-01 00:00:00</td>
<td>2</td>
<td>recall@100.0<sub>pct</sub></td>
<td>1.0</td>
<td>3</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Remember that at 100%, the <code>recall</code> should be 1, and the <code>precision</code> is equal to the <em>baserate</em>. If these two things don't match, there are problems in your data, pipeline, etl. You must get this correct!</p>
</blockquote>
<p><em>What does this query tell us?</em></p>
<p>We can now see how the different instances (trained on different temporal slices, but with the same model params) of a model group performs over time. Note how we only included the <em>models</em> that belong to our <em>model group</em> <code>1</code>.</p>
<h3 id="test_train_resultsaequitas"><code>{test_train}_results.aequitas</code><a class="headerlink" href="#test_train_resultsaequitas" title="Permanent link">#</a></h3>
<p>Standard evaluation metrics don't tell us the entire story: what are the biases in our models? what is the fairest model?<br />
Given the <code>bias_audit_config</code> in the experiment config in which we defined what protected attributes we care about (e.g. ethnicity) and the specific thresholds our model is going to be used,
Triage uses Aequitas to generate a bias report on each model and matrix, similar to standard evaluation metrics.
The <code>aequitas</code> tables will have a row for each combination of:
- model_id
- subset_hash
- tie_breaker (e.g. best, worst)
- evaluation_start_time
- evaluation_end_time
- parameter (e.g. <code>25_abs</code>, similar to evaluation metric thresholds)
- attribute_name (e.g. 'facility_type')
- attribute_value (e.g. 'kids_facility', 'restaurant')</p>
<p>For each row Aequitas calculates the following group metrics:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Formula</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Predicted Positive</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20PP_g"></td>
<td>The number of entities within a group where the decision is positive, i.e.,  <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Cwidehat%7BY%7D%3D1."></td>
</tr>
<tr>
<td><strong>Total Predictive Positive</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20K%20%3D%20%5Csum_%7BA%3Da_1%7D%5E%7BA%3Da_n%7D%20PP_%7Bg%28a_i%29%7D"></td>
<td>The total number of entities predicted positive across groups defined by <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20A."></td>
</tr>
<tr>
<td><strong>Predicted Negative</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20PN_g"></td>
<td>The number of entities within a group which decision is negative, i.e.,  <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D0."></td>
</tr>
<tr>
<td><strong>Predicted Prevalence</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?PPrev_g%20%3D%20%5Cfrac%7BPP_g%7D%7B%7Cg%7C%7D%20%3D%20%5Ctext%7BPr%28%7D%5Cwidehat%7BY%7D%3D1%5C%3B%7C%5C%3BA%3Da_i%29"></td>
<td>The fraction of entities within a group which were predicted as positive.</td>
</tr>
<tr>
<td><strong>Predicted Positive Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?PPR_g%20%3D%20%5Cfrac%7BPP_g%7D%7BK%7D%20%3D%20%5Ctext%7BPr%28%7DA%3Da_i%5C%3B%7C%5C%3B%5Cwidehat%7BY%7D%3D1%29"></td>
<td>The fraction of the entities predicted as positive that belong to a certain group.</td>
</tr>
<tr>
<td><strong>False Positive</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20FP_g"></td>
<td>The number of entities of the group with <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D1"> and <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20Y%3D0."></td>
</tr>
<tr>
<td><strong>False Negative</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20FN_g"></td>
<td>The number of entities of the group with <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D0"> and <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20Y%3D1."></td>
</tr>
<tr>
<td><strong>True Positive</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20TP_g"></td>
<td>The number of entities of the group with <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D1"> and <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20Y%3D1."></td>
</tr>
<tr>
<td><strong>True Negative</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?%5Cinline%20TN_g"></td>
<td>The number of entities of the group with <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20%5Cwidehat%7BY%7D%3D0"> and <img src="http://latex.codecogs.com/gif.latex?%5Cinline%20%5Clarge%20Y%3D0."></td>
</tr>
<tr>
<td><strong>False Discovery Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?FDR_g%20%3D%20%5Cfrac%7BFP_g%7D%7BPP_g%7D%20%3D%20%5Ctext%7BPr%28%7DY%3D0%5C%3B%7C%5C%3B%5Cwidehat%7BY%7D%3D1%2CA%3Da_i%29"></td>
<td>The fraction of false positives of a group within the predicted positive of the group.</td>
</tr>
<tr>
<td><strong>False Omission Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?FOR_g%20%3D%20%5Cfrac%7BFN_g%7D%7BPN_g%7D%20%3D%20%5Ctext%7BPr%28%7DY%3D1%5C%3B%7C%5C%3B%5Cwidehat%7BY%7D%3D0%2CA%3Da_i%29"></td>
<td>The fraction of false negatives of a group within the predicted negative of the group.</td>
</tr>
<tr>
<td><strong>False Positive Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?FPR_g%20%3D%20%5Cfrac%7BFP_g%7D%7BLN_g%7D%20%3D%20%5Ctext%7BPr%28%7D%5Cwidehat%7BY%7D%3D1%5C%3B%7C%5C%3BY%3D0%2CA%3Da_i%29"></td>
<td>The fraction of false positives of a group within the labeled negative of the group.</td>
</tr>
<tr>
<td><strong>False Negative Rate</strong></td>
<td><img src="http://latex.codecogs.com/gif.latex?FNR_g%20%3D%20%5Cfrac%7BFN_g%7D%7BLP_g%7D%20%3D%20%5Ctext%7BPr%28%7D%5Cwidehat%7BY%7D%3D0%5C%3B%7C%5C%3BY%3D1%2C%20A%3Da_i%29"></td>
<td>The fraction of false negatives of a group within the labeled positives of the group.</td>
</tr>
</tbody>
</table>
<p>In the context of public policy and social good we want to avoid providing less benefits to specific groups of entities, if the intervention is assistive, as well as, avoid hurting more
specific groups, if the intervention is punitive. Therefore we define bias as a disparity measure of group metric values of a given group when compared with a reference group. This
reference can be selected using different criteria. For instance, one could use the majority group (with larger size) across the groups defined by A, or the group with minimum
group metric value, or the traditional approach of fixing a historically favored group (e.g ethnicity:caucasian).</p>
<p>Each disparity metric <img src="http://latex.codecogs.com/gif.latex?j"> for a given group <img src="http://latex.codecogs.com/gif.latex?a_i"> is calculated as follows:
<img src="http://latex.codecogs.com/gif.latex?disparity_%7Bj%2C%5C%3Ba_%7Bi%7D%7D%20%3D%20%5Cfrac%7Bmetric_%7Bj%2C%5C%3Ba_%7Bi%7D%7D%7D%7Bmetric_%7Bj%2C%5C%3Ba_%7Breference%5C%3Bgroup%7D%7D%7D"></p>
<p>To read about the bias metrics saved in this table, look at the <a href="https://dssg.github.io/aequitas/output_data.html">Aequitas documentation</a>.</p>
<table>
<thead>
<tr>
<th>Table "test_results.aequitas"</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>Type</td>
<td>Collation</td>
<td>Nullable</td>
<td>Default</td>
</tr>
<tr>
<td>model_id</td>
<td>integer</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>subset_hash</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>tie_breaker</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>evaluation_start_time</td>
<td>timestamp without time zone</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>evaluation_end_time</td>
<td>timestamp without time zone</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>matrix_uuid</td>
<td>text</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>parameter</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>attribute_name</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>attribute_value</td>
<td>character varying</td>
<td></td>
<td>not null</td>
<td></td>
</tr>
<tr>
<td>total_entities</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_label_pos</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_label_neg</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_size</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_size_pct</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>prev</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pp</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pn</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fp</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fn</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tn</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tp</td>
<td>integer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ppr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pprev</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tpr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tnr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>for</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fdr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fpr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fnr</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>npv</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>precision</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ppr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ppr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pprev_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>pprev_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>precision_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>precision_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fdr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fdr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>for_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>for_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fpr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fpr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fnr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>fnr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tpr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tpr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tnr_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>tnr_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>npv_disparity</td>
<td>numeric</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>npv_ref_group_value</td>
<td>character varying</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Statistical_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Impact_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FDR_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FPR_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FOR_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FNR_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TypeI_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TypeII_Parity</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Equalized_Odds</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Unsupervised_Fairness</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Supervised_Fairness</td>
<td>boolean</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="test-train_resultspredictions"><code>{test, train}_results.predictions</code><a class="headerlink" href="#test-train_resultspredictions" title="Permanent link">#</a></h3>
<p>You can think of the previous table <code>{test, train}_results.{test, train}_predictions</code> as a summary of individuals predictions that our model is making. But where can you find the individual predictions that our model is making? (So you can generate a list from here). And where can we find the test matrix that the predictions are based on? Let us introduce you to the <code>results.predictions</code> table.</p>
<p>Here is what its first row looks like:</p>
<div class="highlight"><pre><span></span><span class="k">select</span>
    <span class="n">model_id</span><span class="p">,</span>
    <span class="n">entity_id</span><span class="p">,</span>
    <span class="n">as_of_date</span><span class="p">,</span>
    <span class="n">score</span><span class="p">,</span>
    <span class="n">label_value</span><span class="p">,</span>
    <span class="n">matrix_uuid</span>
<span class="k">from</span>
    <span class="n">test_results</span><span class="p">.</span><span class="n">predictions</span>
<span class="k">where</span>
    <span class="n">model_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">score</span> <span class="k">desc</span><span class="p">;</span>
</pre></div>

<table>
<thead>
<tr>
<th>model<sub>id</sub></th>
<th>entity<sub>id</sub></th>
<th>as<sub>of</sub><sub>date</sub></th>
<th>score</th>
<th>label<sub>value</sub></th>
<th>matrix<sub>uuid</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>229</td>
<td>2016-01-01 00:00:00</td>
<td>1.0</td>
<td>1</td>
<td>cd0ae68d6ace43033b49ee0390c3583e</td>
</tr>
<tr>
<td>1</td>
<td>355</td>
<td>2016-01-01 00:00:00</td>
<td>1.0</td>
<td>1</td>
<td>cd0ae68d6ace43033b49ee0390c3583e</td>
</tr>
<tr>
<td>1</td>
<td>840</td>
<td>2016-01-01 00:00:00</td>
<td>1.0</td>
<td>0</td>
<td>cd0ae68d6ace43033b49ee0390c3583e</td>
</tr>
</tbody>
</table>
<p>As you can see, the table contains our models' predictions for a given entity and date.</p>
<p>And do you notice the field <code>matrix_uuid</code>? Doesn't it look similar to the fields from above that gave us the names of our training matrices? In fact, it is the same. You can find the test matrix that was used to make this prediction under <code>TRIAGE_OUTPUT_PATH/matrices/{matrix_uuid}.csv</code>.</p>
<h3 id="test-train_resultsfeature_importances"><code>{test, train}_results.feature_importances</code><a class="headerlink" href="#test-train_resultsfeature_importances" title="Permanent link">#</a></h3>
<p>This tables store the feature importance of all the models.</p>
<h2 id="footnotes">Footnotes<a class="headerlink" href="#footnotes" title="Permanent link">#</a></h2>
<p><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> Literally from the configuration file. If you modify something it will generate a new hash. Handle with care!</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../postmodeling/" title="Postmodeling" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Postmodeling
              </span>
            </div>
          </a>
        
        
          <a href="../aws_batch/" title="Scaling up" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Scaling up
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/dssg/triage" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/datascifellows" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/company/center-for-data-science-and-public-policy-university-of-chicago" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/mermaid.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>